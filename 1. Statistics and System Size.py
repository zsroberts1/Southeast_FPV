# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2025-04-16 18:08:16
"""
import arcpy

def StatsSystemSize():  # 1. Statistics and System Size

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    arcpy.ImportToolbox(r"d:\arcgis\Resources\ArcToolbox\toolboxes\Data Management Tools.tbx")
    SE_Lakes_climatecrisis = "E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis"
    SE_Lakes_biodiversity_scenario = "E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_biodiversity_scenario"

    # Process: Summary Statistics (Summary Statistics) (analysis)
    ClimateCrisis_Stats = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\ClimateCrisis_Stats"
    arcpy.analysis.Statistics(in_table=SE_Lakes_climatecrisis, out_table=ClimateCrisis_Stats, statistics_fields=[["AREASQKM", "SUM"], ["AREASQKM", "MEAN"], ["AREASQKM", "MIN"], ["AREASQKM", "MAX"], ["AREASQKM", "MEDIAN"]])

    # Process: Summary Statistics (2) (Summary Statistics) (analysis)
    Biodiversity_stats = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Biodiversity_stats"
    arcpy.analysis.Statistics(in_table=SE_Lakes_biodiversity_scenario, out_table=Biodiversity_stats, statistics_fields=[["AREASQKM", "SUM"], ["AREASQKM", "MEAN"], ["AREASQKM", "MIN"], ["AREASQKM", "MAX"], ["AREASQKM", "MEDIAN"]])

    # Process: Export Features (2) (Export Features) (conversion)
    Climatecrisis_Coords = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords"
    arcpy.conversion.ExportFeatures(in_features=SE_Lakes_climatecrisis, out_features=Climatecrisis_Coords, field_mapping="Join_Count \"Join_Count\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Join_Count,-1,-1;TARGET_FID \"TARGET_FID\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,TARGET_FID,-1,-1;COMID \"COMID\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,COMID,-1,-1;FDATE \"FDATE\" true true false 8 Date 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,FDATE,-1,-1;GNIS_ID \"GNIS_ID\" true true false 10 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,GNIS_ID,0,9;GNIS_NAME \"GNIS_NAME\" true true false 65 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,GNIS_NAME,0,64;AREASQKM \"AREASQKM\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,AREASQKM,-1,-1;ELEVATION \"ELEVATION\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,ELEVATION,-1,-1;REACHCODE \"REACHCODE\" true true false 14 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,REACHCODE,0,13;FTYPE \"FTYPE\" true true false 24 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,FTYPE,0,23;FCODE \"FCODE\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,FCODE,-1,-1;ONOFFNET \"ONOFFNET\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,ONOFFNET,-1,-1;MeanDepth \"MeanDepth\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,MeanDepth,-1,-1;LakeVolume \"LakeVolume\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,LakeVolume,-1,-1;MaxDepth \"MaxDepth\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,MaxDepth,-1,-1;LakeArea \"LakeArea\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,LakeArea,-1,-1;FCODEDesc \"FCODEDesc\" true true false 50 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,FCODEDesc,0,49;Esri_Symbo \"Esri_Symbo\" true true false 10 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Esri_Symbo,0,9;PopupTitle \"PopupTitle\" true true false 100 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,PopupTitle,0,99;PopupSubti \"PopupSubti\" true true false 45 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,PopupSubti,0,44;Shape__Are \"Shape__Are\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Shape__Are,-1,-1;Shape__Len \"Shape__Len\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Shape__Len,-1,-1;GlobalID \"GlobalID\" true true false 38 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,GlobalID,0,37;Shape_Leng \"Shape_Length\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Shape_Leng,-1,-1;STATE_NAME \"State Name\" true true false 20 Text 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,STATE_NAME,0,19;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0,First,#,E:\\ArcPro\\FPV_Suitability_SE\\FPV_Suitability_SE.gdb\\SE_Lakes_climatecrisis,Shape_Area,-1,-1")

    # Process: Calculate Geometry Attributes (Calculate Geometry Attributes) (management)
    Climatecrisis_Coords_7_ = arcpy.management.CalculateGeometryAttributes(in_features=Climatecrisis_Coords, geometry_property=[["Lat_string", "CENTROID_Y"], ["Lon_string", "CENTROID_X"]], coordinate_system="PROJCS[\"USA_Contiguous_Albers_Equal_Area_Conic_USGS_version\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Albers\"],PARAMETER[\"False_Easting\",0.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-96.0],PARAMETER[\"Standard_Parallel_1\",29.5],PARAMETER[\"Standard_Parallel_2\",45.5],PARAMETER[\"Latitude_Of_Origin\",23.0],UNIT[\"Meter\",1.0]]", coordinate_format="DMS_PACKED")[0]

    # Process: Calculate Fields (multiple) (2) (Calculate Fields (multiple)) (management)
    Climatecrisis_Coords_4_ = arcpy.management.CalculateFields(in_table=Climatecrisis_Coords_7_, expression_type="PYTHON3", fields=[["Lat", "str(round(float(!Lat_string!),3))", "", "TEXT"], ["Lon", "str(round(float(!Lon_string!),3))", "", "TEXT"], ["weather_files", "ConcatenateFields(!Lat!, !Lon!) + \".csv\"", "", "TEXT"]], code_block="""# Joins two or more fields into a single string value
# More calculator examples at esriurl.com/CalculatorExamples
def ConcatenateFields(*args):
    sep = \"_\"
    return sep.join([i for i in args if i])""")[0]

    # Process: Add Fields (multiple) (Add Fields (multiple)) (management)
    Climatecrisis_Coords_6_ = arcpy.management.AddFields(in_table=Climatecrisis_Coords_4_, field_description=[["fpv_system_size_kw", "LONG", "", "", "", ""]])[0]

    # Process: Calculate Field (Calculate Field) (management)
    Climatecrisis_Coords_2_ = arcpy.management.CalculateField(in_table=Climatecrisis_Coords_6_, field="fpv_system_size_kw", expression="int((!AREASQKM!*100*1000)*.27) + 0.5")[0]

    # Process: Export Table (Export Table) (conversion)
    ClimateCrisis_Coords_csv = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\Data\\ClimateCrisis_Coords.csv"
    arcpy.conversion.ExportTable(in_table=Climatecrisis_Coords_2_, out_table=ClimateCrisis_Coords_csv, field_mapping="COMID \"COMID\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,COMID,-1,-1;AREASQKM \"AREASQKM\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,AREASQKM,-1,-1;STATE_NAME \"State Name\" true true false 20 Text 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,STATE_NAME,0,19;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,Shape_Area,-1,-1;Lat \"Lat\" true true false 512 Text 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,Lat,0,511;Lon \"Lon\" true true false 512 Text 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,Lon,0,511;weather_files \"weather_files\" true true false 512 Text 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,weather_files,0,511;fpv_system_size_kw \"fpv_system_size_kw\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Climatecrisis_Coords,fpv_system_size_kw,-1,-1")

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(autoCommit=1000, baUseDetailedAggregation=False, cellAlignment="DEFAULT", 
                          cellSize="MAXOF", cellSizeProjectionMethod="CONVERT_UNITS", coincidentPoints="MEAN", 
                          compression="LZ77", maintainAttachments=True, maintainSpatialIndex=False, 
                          matchMultidimensionalVariable=True, nodata="NONE", outputMFlag="Same As Input", 
                          outputZFlag="Same As Input", preserveGlobalIds=False, pyramid="PYRAMIDS -1 NEAREST DEFAULT 75 NO_SKIP NO_SIPS", 
                          qualifiedFieldNames=True, randomGenerator="0 ACM599", rasterStatistics="STATISTICS 1 1", 
                          resamplingMethod="NEAREST", scratchWorkspace="E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb", terrainMemoryUsage=False, 
                          tileSize="128 128", tinSaveVersion="CURRENT", transferDomains=False, 
                          transferGDBAttributeProperties=False, unionDimension=False, workspace="E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb"):
        StatsSystemSize()
