# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2025-04-16 18:09:23
"""
import arcpy
from testMPatbx.StormCount import StormCount

def WaterbodiesAndStormCounts():  # 5. Waterbodies with Storm Counts

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    arcpy.ImportToolbox(r"d:\arcgis\Resources\ArcToolbox\toolboxes\Conversion Tools.tbx")
    SE_Lakes_climatecrisis_SE_Lakes_climatecrisis_2_ = "ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis"
    SE_states = "SE_states"

    # Process: Export Features (3) (Export Features) (conversion)
    Waterbody_Stormcount = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount"
    arcpy.conversion.ExportFeatures(in_features=SE_Lakes_climatecrisis_SE_Lakes_climatecrisis_2_, out_features=Waterbody_Stormcount, field_mapping="COMID \"COMID\" true true false 4 Long 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,COMID,-1,-1;AREASQKM \"AREASQKM\" true true false 4 Float 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,AREASQKM,-1,-1;ELEVATION \"ELEVATION\" true true false 4 Long 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,ELEVATION,-1,-1;STATE_NAME \"State Name\" true true false 20 Text 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,STATE_NAME,0,19;Year1_Energy_kWh \"Year1_Energy_kWh\" true true false 8 Double 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,Year1_Energy_kWh,-1,-1;System_Size_kW \"System_Size_kW\" true true false 8 Double 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,System_Size_kW,-1,-1;Capacity_Factor \"Capacity_Factor\" true true false 8 Double 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,Capacity_Factor,-1,-1;Energy_Yield \"Energy_Yield\" true true false 8 Double 0 0,First,#,ModelBuilder\\SE_Lakes_climatecrisis:SE_Lakes_climatecrisis,Energy_Yield,-1,-1")

    # Process: Storm Count (5a. Storm Count) (testMPatbx)
    Waterbody_Stormcount_3_ = StormCount(Waterbody_Stormcount_Waterbody_Stormcount=Waterbody_Stormcount)[0]

    # Process: Delete Field (Delete Field) (management)
    Waterbody_Stormcount_5_ = arcpy.management.DeleteField(in_table=Waterbody_Stormcount_3_, drop_field=["id", "id_1", "COUNT", "FIRST_name", "TRACK_DURATION", "START_DATE", "END_DATE", "id_12", "COUNT_1", "FIRST_name_1", "TRACK_DURATION_1", "START_DATE_1", "END_DATE_1"])[0]

    # Process: Alter Fields (multiple) (Alter Fields (multiple)) (management)
    Waterbody_Stormcount_4_ = arcpy.management.AlterFields(in_table=Waterbody_Stormcount_5_, field_description=[["Join_Count", "StormCount_34_kt", "34 Knot Storm Count", "LONG", "", "", ""], ["Join_Count_1", "StormCount_50_kt", "50 Knot Storm Count", "LONG", "", "", ""], ["Join_Count_12", "StormCount_64_kt", "64 Knot Storm Count", "LONG", "", "", ""]])[0]

    # Process: Project (Project) (management)
    SE_States_Stormcount_2_ = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\SE_States_Stormcount"
    arcpy.management.Project(in_dataset=SE_states, out_dataset=SE_States_Stormcount_2_, out_coor_system="PROJCS[\"USA_Contiguous_Albers_Equal_Area_Conic_USGS_version\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Albers\"],PARAMETER[\"False_Easting\",0.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-96.0],PARAMETER[\"Standard_Parallel_1\",29.5],PARAMETER[\"Standard_Parallel_2\",45.5],PARAMETER[\"Latitude_Of_Origin\",23.0],UNIT[\"Meter\",1.0]]")

    # Process: Export Features (Export Features) (conversion)
    Waterbody_copy = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_copy"
    arcpy.conversion.ExportFeatures(in_features=Waterbody_Stormcount_4_, out_features=Waterbody_copy, field_mapping="COMID \"COMID\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,COMID,-1,-1;AREASQKM \"AREASQKM\" true true false 4 Float 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,AREASQKM,-1,-1;ELEVATION \"ELEVATION\" true true false 4 Long 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,ELEVATION,-1,-1;STATE_NAME \"State Name\" true true false 20 Text 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,STATE_NAME,0,19;Year1_Energy_kWh \"Year1_Energy_kWh\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,Year1_Energy_kWh,-1,-1;System_Size_kW \"System_Size_kW\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,System_Size_kW,-1,-1;Capacity_Factor \"Capacity_Factor\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,Capacity_Factor,-1,-1;Energy_Yield \"Energy_Yield\" true true false 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,Energy_Yield,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,Shape_Area,-1,-1;StormCount_34_kt \"34 Knot Storm Count\" true true false 0 Long 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,StormCount_34_kt,-1,-1;StormCount_50_kt \"50 Knot Storm Count\" true true false 0 Long 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,StormCount_50_kt,-1,-1;StormCount_64_kt \"64 Knot Storm Count\" true true false 0 Long 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb\\Waterbody_Stormcount,StormCount_64_kt,-1,-1")

    # Process: Join Field (Join Field) (management)
    SE_States_Stormcount = arcpy.management.JoinField(in_data=SE_States_Stormcount_2_, in_field="STATE_NAME", join_table=Waterbody_copy, join_field="STATE_NAME", fm_option="USE_FM", field_mapping="STATE_NAME \"State Name\" true true false 20 Text 0 0,First,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,STATE_NAME,0,19;Waterbody_Count \"Waterbody Count\" true true false 255 Long 0 0,Count,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,COMID,-1,-1;AREASQKM \"AREASQKM\" true true false 4 Float 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,AREASQKM,-1,-1;StormCount_34_kt \"34 Knot Storm Count\" true true false 4 Long 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,StormCount_34_kt,-1,-1;StormCount_50_kt \"50 Knot Storm Count\" true true false 4 Long 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,StormCount_50_kt,-1,-1;StormCount_64_kt \"64 Knot Storm Count\" true true false 4 Long 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,StormCount_64_kt,-1,-1;Year1_Energy_kWh \"Year1_Energy_kWh\" true true false 8 Double 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,Year1_Energy_kWh,-1,-1;System_Size_kW \"System_Size_kW\" true true false 8 Double 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,System_Size_kW,-1,-1;Capacity_Factor \"Capacity_Factor\" true true false 8 Double 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,Capacity_Factor,-1,-1;Energy_Yield \"Energy_Yield\" true true false 8 Double 0 0,Sum,#,E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb\\Waterbody_copy,Energy_Yield,-1,-1")[0]

    # Process: Table To Excel (Table To Excel) (conversion)
    Waterbody_Stormcount_Excel_xlsx = "E:\\ArcPro\\Social_and_Precautionary\\testMP\\Waterbody_Stormcount_Excel.xlsx"
    arcpy.conversion.TableToExcel(Input_Table=[Waterbody_Stormcount_4_, SE_States_Stormcount], Output_Excel_File=Waterbody_Stormcount_Excel_xlsx, Use_field_alias_as_column_header="ALIAS")

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(autoCommit=1000, baUseDetailedAggregation=False, cellAlignment="DEFAULT", 
                          cellSize="MAXOF", cellSizeProjectionMethod="CONVERT_UNITS", coincidentPoints="MEAN", 
                          compression="LZ77", maintainAttachments=True, maintainSpatialIndex=False, 
                          matchMultidimensionalVariable=True, nodata="NONE", outputMFlag="Same As Input", 
                          outputZFlag="Same As Input", preserveGlobalIds=False, pyramid="PYRAMIDS -1 NEAREST DEFAULT 75 NO_SKIP NO_SIPS", 
                          qualifiedFieldNames=True, randomGenerator="0 ACM599", rasterStatistics="STATISTICS 1 1", 
                          resamplingMethod="NEAREST", scratchWorkspace="E:\\ArcPro\\Social_and_Precautionary\\testMP\\Scratch\\scratch.gdb", terrainMemoryUsage=False, 
                          tileSize="128 128", tinSaveVersion="CURRENT", transferDomains=False, 
                          transferGDBAttributeProperties=False, unionDimension=False, workspace="E:\\ArcPro\\Social_and_Precautionary\\testMP\\testMP.gdb"):
        WaterbodiesAndStormCounts()
